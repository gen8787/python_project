$(document).ready(function() {
    console.log("Document Ready")

// ZIP Code API - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    $("#form_zip").submit(function(event){
        event.preventDefault()
        var zip = $("#form_zipcode").val()
        var city = $("#form_city").val()
        var state = $("#form_state").val()
            
            $.get("https://maps.googleapis.com/maps/api/geocode/json?address=" + zip + "&key=AIzaSyALgoUzjRBprBKw9JtbscY6rkmdZkjyKws",
            function(res){
                console.log(res)
                var lat = res['results']['0']['geometry']['location']['lat']
                var lon = res['results']['0']['geometry']['location']['lng']
                console.log(lat, lon)

            // // Create Map
            var mymap = L.map('mapid').setView([lat, lon], 10);
            L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
                maxZoom: 17,
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' + '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' + 'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
            }).addTo(mymap);
            // // 
            
            
            $.get("https://www.mountainproject.com/data/get-routes-for-lat-lon?lat="+lat+"&lon="+lon+"&maxDistance=10&minDiff=5.6&maxDiff=5.10&maxResults=10&key=106838734-05344d7002476a0d76531a206c4c4ba3",
            function(res){
                console.log(res)
                html_output = "<table class='table'><thead><th>Route Name</th><th>Difficulty</th><th>Pitches</th><th>Type</th><th>Location</th><th>Add</th></thead><tbody>"
                for(var i = 0; i < res.routes.length; i ++){
                    html_output += "<tr><td><a href="+res.routes[i].url+" target='_blank'>"+res.routes[i].name+"</a>"+"</td><td>"+res.routes[i].rating+"</td><td>"+res.routes[i].pitches+"</td><td>"+res.routes[i].type+"</td><td>"+res.routes[i].location[2]+", "+res.routes[i].location[3]+", "+res.routes[i].location[4]+"</td><td><a href='/add_route/"+res.routes[i].id+"'>+</a></td></tr>"
                }
                html_output += "</tbody></table>"
                $('#mp_profile').html(html_output)

                for(var r = 0; r < res.routes.length; r ++){
                    // Create Marker
                    var marker = L.marker([res.routes[r].latitude, res.routes[r].longitude]).addTo(mymap);
                    // Create Popup
                    marker.bindPopup("<b>"+res.routes[r].name+"</b><br>"+res.routes[r].type+" | "+res.routes[r].rating+" | "+res.routes[r].pitches+" pitches")
                }
            })
        })
    })
// LEAFLET - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

    // // // Create Map
    // var mymap = L.map('mapid').setView([37.1102, -118.4912], 13);

	// L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
	// 	maxZoom: 17,
	// 	attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' + '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' + 'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
	// }).addTo(mymap);
    // // // 

    // // Create Marker
    // var marker = L.marker([37.1102, -118.4912]).addTo(mymap);

    // // Create Popup
    // marker.bindPopup("<b>Temple Crag</b><br>Let's climb here!").openPopup();

    // // Map Click Location
    // var popup = L.popup();

    // function onMapClick(e) {
    //     popup
    //         .setLatLng(e.latlng)
    //         .setContent("You clicked the map at " + e.latlng.toString())
    //         .openOn(mymap);
    //         console.log(e.latlng.toString())
    // }
    // mymap.on('click', onMapClick);

    // // Double Click
    // function onMapDblClick(e){
    //     marker
    //         .setLatLng(e.latlng)
    //         .addTo(mymap);
    // }
    // mymap.on('dblclick', onMapDblClick);

    // // 
    // var temple_crag = {"features":[{"geometry":{"coordinates":[[-118.42778921127321,37.12821179568336],[-118.42778,37.12821366956227],[-118.42778,37.12834],[-118.42769,37.12843],[-118.42833,37.12847],[-118.42872,37.12839],[-118.42905,37.12811],[-118.42945,37.1281],[-118.42963,37.12795],[-118.42982,37.12784],[-118.43038,37.12785],[-118.43066,37.12781],[-118.43077,37.12774],[-118.43096,37.12771],[-118.43103,37.12764],[-118.43117,37.1276],[-118.43117,37.1276],[-118.43141,37.12758],[-118.43159,37.1277],[-118.43189,37.12771],[-118.43196,37.12775],[-118.43217,37.12771],[-118.43233,37.12762],[-118.43262,37.12754],[-118.43262,37.12754],[-118.43287,37.12751],[-118.43346,37.12735],[-118.43381,37.12734],[-118.43436,37.12721],[-118.4353,37.12718],[-118.43603,37.12711],[-118.43664,37.12694],[-118.43689,37.12691],[-118.4382,37.1266],[-118.4388,37.12651],[-118.44131,37.12622],[-118.44198,37.12619],[-118.44249,37.12608],[-118.44281,37.12607],[-118.44306,37.12615],[-118.4434,37.12638],[-118.44401,37.12702],[-118.44434,37.12763],[-118.44447831385278,37.12782077772799],[-118.44447831385278,37.12782077772799],[-118.44463,37.12803],[-118.44519,37.12924],[-118.4463,37.13094],[-118.44795,37.13261],[-118.44918,37.13351],[-118.44956,37.13369],[-118.44989,37.13396],[-118.45077,37.13455],[-118.45077,37.13455],[-118.45179,37.13503],[-118.45295,37.13548],[-118.45382,37.1356],[-118.45411,37.13547],[-118.45459,37.13481],[-118.45459,37.13481],[-118.45481,37.13446],[-118.45493,37.13413],[-118.45493,37.13465],[-118.45508,37.13419],[-118.45514,37.13417],[-118.45519,37.1342],[-118.45521,37.13449],[-118.45531,37.13432],[-118.45538,37.13426],[-118.45595,37.13444],[-118.456,37.13464],[-118.45632,37.1352],[-118.45687,37.13578],[-118.45732,37.13617],[-118.45764,37.13632],[-118.45929,37.13697],[-118.45965,37.13706],[-118.46006,37.13719],[-118.46047,37.13717],[-118.4606,37.13711],[-118.46059530973436,37.137109529009116],[-118.46059593570195,37.13711187582987],[-118.4606,37.13711],[-118.46168,37.13705],[-118.46223,37.13694],[-118.46261,37.13679],[-118.46334,37.13633],[-118.46392,37.13622],[-118.46444,37.13622],[-118.46503,37.13616],[-118.46528,37.13609],[-118.46565,37.13588],[-118.46605,37.13589],[-118.46631,37.13559],[-118.46697,37.13542],[-118.46745,37.13539],[-118.46801,37.13544],[-118.46824,37.13535],[-118.46832,37.13505],[-118.46841,37.13509],[-118.46851,37.13528],[-118.46862,37.13516],[-118.46872,37.13539],[-118.46907,37.13526],[-118.46926,37.13527],[-118.46939,37.13533],[-118.46956,37.13537],[-118.46974,37.13535],[-118.46994,37.13498],[-118.47001,37.13453],[-118.47023,37.13458],[-118.47027,37.13422],[-118.47052,37.13373],[-118.47083,37.13336],[-118.47122,37.13307],[-118.47132,37.13289],[-118.47136,37.13274],[-118.47155,37.13251],[-118.47167,37.13269],[-118.47215,37.13217],[-118.47227,37.13198],[-118.47221,37.13175],[-118.47231,37.13152],[-118.47243,37.13146],[-118.47251,37.13131],[-118.47256,37.13154],[-118.47286,37.13156],[-118.47321,37.13134],[-118.47332,37.13101],[-118.47336,37.13061],[-118.47313,37.13004],[-118.47314,37.12993],[-118.47327,37.12981],[-118.4734,37.12964],[-118.47354,37.12966],[-118.47385,37.12978],[-118.47485,37.12926],[-118.47494,37.12904],[-118.47507,37.12889],[-118.47518,37.12888],[-118.4756,37.12862],[-118.47593,37.12861],[-118.47656,37.12853],[-118.47656,37.12853],[-118.4776,37.12845],[-118.47819,37.12845],[-118.47877,37.12855],[-118.47888,37.1285],[-118.47918,37.12853],[-118.47944,37.12851],[-118.47976,37.12858],[-118.48032,37.12878],[-118.48051,37.12899],[-118.481,37.12915],[-118.48065,37.12888],[-118.48071,37.12876],[-118.48078,37.1287],[-118.48088,37.12868],[-118.48095,37.12869],[-118.48094,37.12877],[-118.48083,37.12882],[-118.48091,37.12889],[-118.48133,37.12896],[-118.48166,37.1291],[-118.48172,37.12928],[-118.48203,37.1294],[-118.48218,37.12954],[-118.48216,37.12964],[-118.48184,37.12971],[-118.48227,37.12976],[-118.48302,37.12978],[-118.48352,37.12963],[-118.48356,37.12971],[-118.48427999636829,37.129570001453146],[-118.48427999636829,37.129570001453146],[-118.48428,37.12957],[-118.48453,37.1295],[-118.48456,37.12931],[-118.48428,37.12917],[-118.48459,37.12909],[-118.48476,37.12877],[-118.48483,37.12844],[-118.48489805930143,37.128408032752354],[-118.48489805930143,37.128408032752354],[-118.48549,37.12813],[-118.4858,37.12777],[-118.48589,37.12745],[-118.48569,37.12712],[-118.4858,37.12706],[-118.48596,37.12705],[-118.486,37.12688],[-118.48623,37.12657],[-118.48616,37.12646],[-118.48677,37.12598],[-118.48697,37.12596],[-118.48706,37.12598],[-118.48706,37.12598],[-118.48722,37.12586],[-118.48722512407413,37.12582413148105],[-118.48510265350342,37.124601938655],[-118.48463058471681,37.1237636059907],[-118.48490953445436,37.12260019017527],[-118.487548828125,37.113839779277825],[-118.48681926727296,37.113326442514314],[-118.48847150802614,37.11117039010567],[-118.49063873291017,37.11067414713081],[-118.49072456359865,37.11026346083037],[-118.48823547363281,37.11004100482105],[-118.48679780960084,37.10952764230558],[-118.48570346832277,37.10927095974288],[-118.48555326461793,37.11026346083037],[-118.48497390747072,37.11250509645423],[-118.48632574081422,37.11587598082559],[-118.48445892333986,37.1238149327472],[-118.48514556884767,37.124875677922226],[-118.48688364028932,37.12579954064011],[-118.48619699478151,37.12650098443158],[-118.48618842334247,37.12650466525243],[-118.48623,37.12657],[-118.486,37.12688],[-118.48596,37.12705],[-118.4858,37.12706],[-118.48569,37.12712],[-118.48589,37.12745],[-118.4858,37.12777],[-118.48549,37.12813],[-118.48483,37.12844],[-118.48476,37.12877],[-118.48459,37.12909],[-118.48428,37.12917],[-118.48456,37.12931],[-118.48453,37.1295],[-118.48428,37.12957],[-118.48427999636829,37.129570001453146],[-118.48427999636829,37.129570001453146],[-118.48356,37.12971],[-118.48352,37.12963],[-118.48302,37.12978],[-118.48227,37.12976],[-118.48184,37.12971],[-118.48216,37.12964],[-118.48218,37.12954],[-118.48203,37.1294],[-118.48172,37.12928],[-118.48166,37.1291],[-118.48133,37.12896],[-118.48091,37.12889],[-118.48083,37.12882],[-118.48094,37.12877],[-118.48095,37.12869],[-118.48088,37.12868],[-118.48078,37.1287],[-118.48071,37.12876],[-118.48065,37.12888],[-118.481,37.12915],[-118.48051,37.12899],[-118.48032,37.12878],[-118.47976,37.12858],[-118.47944,37.12851],[-118.47918,37.12853],[-118.47888,37.1285],[-118.47877,37.12855],[-118.47819,37.12845],[-118.4776,37.12845],[-118.47656,37.12853],[-118.47656,37.12853],[-118.47593,37.12861],[-118.4756,37.12862],[-118.47518,37.12888],[-118.47507,37.12889],[-118.47494,37.12904],[-118.47485,37.12926],[-118.47385,37.12978],[-118.47354,37.12966],[-118.4734,37.12964],[-118.47327,37.12981],[-118.47314,37.12993],[-118.47313,37.13004],[-118.47336,37.13061],[-118.47332,37.13101],[-118.47321,37.13134],[-118.47286,37.13156],[-118.47256,37.13154],[-118.47251,37.13131],[-118.47243,37.13146],[-118.47231,37.13152],[-118.47221,37.13175],[-118.47227,37.13198],[-118.47215,37.13217],[-118.47167,37.13269],[-118.47155,37.13251],[-118.47136,37.13274],[-118.47132,37.13289],[-118.47122,37.13307],[-118.47095625599547,37.13326611733669],[-118.47095625599547,37.13326611733669],[-118.47083,37.13336],[-118.47052,37.13373],[-118.47027,37.13422],[-118.47023,37.13458],[-118.47001,37.13453],[-118.46994,37.13498],[-118.46974,37.13535],[-118.46956,37.13537],[-118.46939,37.13533],[-118.46926,37.13527],[-118.46907,37.13526],[-118.46872,37.13539],[-118.46862,37.13516],[-118.46851,37.13528],[-118.46841,37.13509],[-118.46832,37.13505],[-118.46824,37.13535],[-118.46801,37.13544],[-118.46745,37.13539],[-118.46697,37.13542],[-118.46631,37.13559],[-118.46605,37.13589],[-118.46565,37.13588],[-118.46528,37.13609],[-118.46503,37.13616],[-118.46444,37.13622],[-118.46392,37.13622],[-118.46334,37.13633],[-118.46261,37.13679],[-118.46223,37.13694],[-118.46168,37.13705],[-118.4606,37.13711],[-118.46047,37.13717],[-118.46006,37.13719],[-118.45965,37.13706],[-118.45929,37.13697],[-118.45764,37.13632],[-118.45732,37.13617],[-118.45687,37.13578],[-118.45632,37.1352],[-118.456,37.13464],[-118.45595,37.13444],[-118.45538,37.13426],[-118.45531,37.13432],[-118.45521,37.13449],[-118.45519,37.1342],[-118.45514,37.13417],[-118.45508,37.13419],[-118.45493,37.13465],[-118.45493,37.13413],[-118.45481,37.13446],[-118.45459,37.13481],[-118.45459,37.13481],[-118.45411,37.13547],[-118.45382,37.1356],[-118.45295,37.13548],[-118.45210609382036,37.135152622602725],[-118.45210609382036,37.135152622602725],[-118.45179,37.13503],[-118.45077,37.13455],[-118.45077,37.13455],[-118.44989,37.13396],[-118.44956,37.13369],[-118.44918,37.13351],[-118.44795,37.13261],[-118.4463,37.13094],[-118.44519,37.12924],[-118.44463,37.12803],[-118.44447831385278,37.12782077772799],[-118.44447831385278,37.12782077772799],[-118.44434,37.12763],[-118.44401,37.12702],[-118.4434,37.12638],[-118.44306,37.12615],[-118.44281,37.12607],[-118.44249,37.12608],[-118.44198,37.12619],[-118.44131,37.12622],[-118.4388,37.12651],[-118.4382,37.1266],[-118.43689,37.12691],[-118.43664,37.12694],[-118.43603,37.12711],[-118.4353,37.12718],[-118.43436,37.12721],[-118.43381,37.12734],[-118.43346,37.12735],[-118.43287,37.12751],[-118.43262,37.12754],[-118.43262,37.12754],[-118.43233,37.12762],[-118.43217,37.12771],[-118.43196,37.12775],[-118.43189,37.12771],[-118.43159,37.1277],[-118.43141,37.12758],[-118.43117,37.1276],[-118.43117,37.1276],[-118.43103,37.12764],[-118.43096,37.12771],[-118.43077,37.12774],[-118.43066,37.12781],[-118.43038,37.12785],[-118.42982,37.12784],[-118.42963,37.12795],[-118.42945,37.1281],[-118.42905,37.12811],[-118.42872,37.12839],[-118.42833,37.12847],[-118.42769,37.12843],[-118.42778,37.12834]],"type":"LineString"},"id":"1cbd9321-3cc7-4499-9fe1-f24a568a4c1e","type":"Feature","properties":{"creator":"8VA184","stroke-opacity":1,"pattern":"solid","description":"","stroke-width":2,"title":"Temple Crag","fill":"#FF0000","class":"Shape","updated":1595900490000,"stroke":"#FF0000","fill-opacity":0.1,"gpstype":"TRACK"}}],"type":"FeatureCollection"}
    // L.geoJSON(temple_crag).addTo(mymap)







})